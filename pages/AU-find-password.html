<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로그인/회원가입 - 비밀번호 찾기</title>

    <!-- Link Font -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" />
    <!-- Link Tailwind -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- Link Font-awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
        integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="stylesheet" href="../assets/css/util.css">
    <link rel="stylesheet" href="../assets/css/CO/co.css">
    <link rel="stylesheet" href="../assets/css/AU/au.css">
</head>

<body style="background-color: rgb(247, 247, 247);">

    <header class="bg-white hidden sm:block" style="margin-bottom: 72px;">
        <section class="flex items-center justify-center relative border-b border-b-highlight">
            <div class="py-3">
                <img class="w-14 h-14" src="../assets/images/logo/Logo.svg" alt="" />
            </div>
        </section>
    </header>

    <main>
        <div class="w-full">
            <div class="bg-white sm:rounded-xl overflow-hidden" style="max-width: 460px; margin: 0 auto;">
                
                <div class="px-5 sm:px-0 flex items-center justify-between sm:justify-center py-6 sm:py-0">
                    <h4 class="text-2028-1826 font-semibold text-center py-2.5">비밀번호 찾기</h4>
    
                    <button class="h-6 w-6 flex sm:hidden items-center justify-center"
                        onclick="toggleMdClose()"
                    >
                        <i class="text-sm fa-solid fa-x"></i>
                    </button>
                </div>

                <div class="px-5 py-5 sm:px-14 sm:py-12 shadow-sm">
                    <div class="sm:px-1 sm:py-0.5">
                        <div class="space-y-16 pb-6 sm:pb-0">
                            
                            <div class="flex items-center justify-center gap-x-2">
                                <button id="btn-method-phone" class="flex-1 text-15-l-22 font-semibold py-2.5 rounded border text-blue-500 bg-blue-100 border-blue-500">휴대폰 인증</button>
                                <button id="btn-method-email" class="flex-1 text-15-l-22 font-semibold py-2.5 rounded border">이메일 인증</button>
                            </div>

                            <div class="space-y-5">
                                <!-- name -->
                                <div class="flex flex-col gap-y-2">
                                    <label for="" class="text-sm font-semibold">아이디</label>

                                    <div class="py-2.5 px-4 rounded border">
                                        <input id="input-name" type="text" class="flex-1 text-15-l-22" placeholder="아이디를 입력해주세요">
                                    </div>
                                </div>
                                <!-- phone number -->
                                <div id="frame-phone" class="flex flex-col gap-y-2">
                                    <label for="" class="text-sm font-semibold">휴대폰 번호</label>

                                    <div class="flex items-center gap-x-2">
                                        <div class="py-2.5 px-4 rounded border" style="width: calc(100% - 88px);">
                                            <input id="input-phone" type="text" maxlength="15" class="flex-1 text-15-l-22 w-full" placeholder="'-' 없이 번호만 입력해주세요">
                                        </div>
                                        <button id="btn-auth-phone" type="button" class="text-15-l-22 py-2.5 text-center w-20 rounded border text-gray-300 cursor-default">
                                            인증요청
                                        </button>
                                    </div>
                                </div>

                                <!-- email -->
                                <div id="frame-email" class="flex flex-col gap-y-2 hidden">
                                    <label for="" class="text-sm font-semibold">이메일</label>

                                    <div class="flex items-center gap-x-2">
                                        <div class="py-2.5 px-4 rounded border" style="width: calc(100% - 88px);">
                                            <input id="input-email" type="text" class="flex-1 text-15-l-22 w-full" placeholder="가입시 사용한 이메일을 적어주세요">
                                        </div>
                                        <!-- btn commit -->
                                        <button id="btn-auth-email" type="button" class="text-15-l-22 py-2.5 text-center w-20 rounded border text-gray-300 cursor-default">
                                            인증요청
                                        </button>
                                    </div>
                                </div>

                                <!-- certification -->
                                <div id="frame-certification" class="flex flex-col gap-y-2 hidden">
                                    <label for="" class="text-sm font-semibold">인증번호</label>

                                    <div class="flex items-center gap-x-2">
                                        <div class="py-2.5 px-4 rounded border flex items-center gap-x-2" style="width: calc(100% - 88px);">
                                            <input id="input-certification" type="text" class="flex-1 text-15-l-22 w-full" placeholder="00000">

                                            <span id="timer" class="inline-block text-xs font-normal text-gray-400">05:00</span>
                                        </div>
                                        <!-- btn commit -->
                                        <button id="btn-check" class="text-15-l-22 py-2.5 text-center w-20 rounded border text-gray-300 cursor-default">
                                            확인
                                        </button>
                                    </div>
                                </div>
                            </div>
                           
                            <div class="space-y-3 mb-14">
                                <div class="flex justify-center">
                                    <a href="./AU-find-id.html" class="cursor-pointer text-13-l-18 font-semibold text-gray-500 py-1.5 px-4 whitespace-nowrap">
                                        아이디 찾기
                                    </a>
                                </div>
                            </div>                            
                        </div>
                    </div>
                </div>
            </div>              
        </div>
    </main>

    <div class="h-32"></div>

    <section>
        <!-- modal 1 -->
        <div id="modal-close" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 hidden">
            <!-- Modal Content -->
            <div class="bg-white sm:rounded-lg p-5 sm:p-8" style="width: 364px;">
                <!-- Modal Header -->
                <div class="flex items-center justify-center mb-6">
                    <h3 class="text-1724-1826 font-semibold text-center">로그인/회원가입 진행을 닫으시겠습니까?</h3>                   
                </div>
    
                <!-- Address List -->
                <div class="space-y-5 sm:space-y-6 mb-2.5 sm:mb-6">
                    <!-- Address Item 1 -->
                    <p class="text-xs font-normal text-gray-400 text-center">
                        창을 닫으면 진행중인 사항이 모두 사라집니다.
                    </p>
                </div>
    
                <!-- Select Button -->
                <div class="mt-20 sm:mt-6 pb-1 sm:pb-0 pt-6 sm:pt-0 flex items-center justify-center gap-x-4">
                    <button onclick="toggleMdClose()"
                        class="flex-1 w-full py-2 border rounded-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-100">
                        취소
                    </button>
                    <button onclick="toggleMdClose()"
                        class="flex-1 w-full py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        확인
                    </button>
                </div>
            </div>
        </div>

        <!-- modal 2 -->
        <div id="modal-err-otp" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 hidden">
            <!-- Modal Content -->
            <div class="bg-white sm:rounded-lg p-5 sm:p-8" style="width: 364px;">
                <!-- Modal Header -->
                <div class="flex items-center justify-center mb-6">
                    <h3 class="text-1724-1826 font-semibold text-center">
                        입력하신 인증번호가 맞지 않습니다.
                    </h3>                   
                </div>
    
                <!-- Address List -->
                <!-- <div class="space-y-5 sm:space-y-6 mb-2.5 sm:mb-6">                    
                    <p class="text-xs font-normal text-gray-400 text-center">
                        비밀번호는 영문, 숫자, 특수무자 조합 8자리 이상으로 입력해주시길 바랍니다.
                    </p>
                </div> -->
    
                <!-- Select Button -->
                <div class="mt-20 sm:mt-6 pb-1 sm:pb-0 pt-6 sm:pt-0 flex items-center justify-center gap-x-4">                    
                    <button onclick="toggle('#modal-err-otp')"
                        class="flex-1 w-full py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        확인
                    </button>
                </div>
            </div>
        </div>
    </section>
   
    <script>        
        const inputName = document.querySelector('#input-name')
        const inputPhone = document.querySelector('#input-phone')
        const inputEmail = document.querySelector('#input-email')
        const inputCertification = document.querySelector('#input-certification')
        
        const btnAuthPhone = document.querySelector('#btn-auth-phone')
        const btnAuthEmail = document.querySelector('#btn-auth-email')
        const btnCheck = document.querySelector('#btn-check')
        const btnMethodPhone = document.querySelector('#btn-method-phone')
        const btnMethodEmail = document.querySelector('#btn-method-email')

        const frameCertification = document.querySelector('#frame-certification')
        const framePhone = document.querySelector('#frame-phone')
        const frameEmail = document.querySelector('#frame-email')

        const mdErrOtp = document.querySelector('#modal-err-otp')
        const mdClose = document.querySelector('#modal-close')
        // 
        let countdown;

        inputPhone.addEventListener('input', () => {            
            inputPhone.value = inputPhone.value.replace(/[^0-9]/g, ''); 

            if (inputPhone.value.length > 0) {
                btnAuthPhone.classList.add('border-blue-500')
                btnAuthPhone.classList.add('text-blue-500')
                btnAuthPhone.classList.remove('cursor-default')
            } else {
                btnAuthPhone.classList.remove('border-blue-500')
                btnAuthPhone.classList.remove('text-blue-500')              
                btnAuthPhone.classList.add('cursor-default')              
            }
        })
        
        inputEmail.addEventListener('input', () => {
            const regexEmail = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/


            if (regexEmail.test(inputEmail.value)) {
                btnAuthEmail.classList.add('border-blue-500')
                btnAuthEmail.classList.add('text-blue-500')
                btnAuthEmail.classList.remove('cursor-default')
            } else {
                btnAuthEmail.classList.remove('border-blue-500')
                btnAuthEmail.classList.remove('text-blue-500')              
                btnAuthEmail.classList.add('cursor-default')              
            }
        })

        inputCertification.addEventListener('input', () => {
            inputCertification.value = inputCertification.value.replace(/[^0-9]/g, '');

            if (inputCertification.value.length === 6) {
                btnCheck.classList.add('border-blue-500')
                btnCheck.classList.add('text-blue-500')
                btnCheck.classList.remove('cursor-default')
            } else {
                btnCheck.classList.remove('border-blue-500')
                btnCheck.classList.remove('text-blue-500')              
                btnCheck.classList.add('cursor-default')   
            }
        })

        btnAuthPhone.addEventListener('click', () => {
            if (inputPhone.value.length > 0) {
                btnAuthPhone.textContent = "재전송"
                frameCertification.classList.remove('hidden')
                startCountdown()
            }
        })

        btnAuthEmail.addEventListener('click', () => {
            if (inputEmail.value.length > 0) {
                btnAuthEmail.textContent = "재전송"
                frameCertification.classList.remove('hidden')
                startCountdown()
            }
        })

        btnCheck.addEventListener('click', () => {
            if (inputCertification.value.length !== 6) return

            if (inputCertification.value === "000000") {
                reset()
                // chuyen sang trang ket qua
                window.location.href = "./AU-find-password-change.html"
            } else {
                toggle('#modal-err-otp')
            }
        })

        btnMethodPhone.addEventListener('click', () => {
            reset()
            // text-blue-500 bg-blue-100 border-blue-500
            btnMethodPhone.classList.add('text-blue-500')
            btnMethodPhone.classList.add('bg-blue-100')
            btnMethodPhone.classList.add('border-blue-500')
           
            btnMethodEmail.classList.remove('text-blue-500')
            btnMethodEmail.classList.remove('bg-blue-100')
            btnMethodEmail.classList.remove('border-blue-500')

            framePhone.classList.remove('hidden')
            frameEmail.classList.add('hidden')
        })
        
        btnMethodEmail.addEventListener('click', () => {
            reset()

            btnMethodEmail.classList.add('text-blue-500')
            btnMethodEmail.classList.add('bg-blue-100')
            btnMethodEmail.classList.add('border-blue-500')

            btnMethodPhone.classList.remove('text-blue-500')
            btnMethodPhone.classList.remove('bg-blue-100')
            btnMethodPhone.classList.remove('border-blue-500')
            
            frameEmail.classList.remove('hidden')
            framePhone.classList.add('hidden')
        })

        function reset() {
            clearInterval(countdown)
            document.getElementById('timer').textContent = '05' + ':' + '00';
            frameCertification.classList.add('hidden')
        }

        function toggleMdClose() {
            mdClose.classList.toggle('hidden')
        }

        function startCountdown() {
            clearInterval(countdown);
            // Thời gian bắt đầu (5 phút = 300 giây)
            let time = 300;
            const displayTime = document.getElementById('timer');

            // Hàm đếm ngược
            countdown = setInterval(function() {
                let minutes = Math.floor(time / 60);
                let seconds = time % 60;

                // Đảm bảo định dạng luôn là 2 chữ số
                minutes = minutes < 10 ? '0' + minutes : minutes;
                seconds = seconds < 10 ? '0' + seconds : seconds;

                // Hiển thị thời gian còn lại
                displayTime.textContent = minutes + ':' + seconds;

                // Giảm thời gian
                if (time === 0) {
                    clearInterval(countdown);
                    toggle('#modal-err-otp')
                } else {
                    time--;
                }
            }, 1000); // Cập nhật mỗi giây
        }

        function toggle(stringQuery) {
            document.querySelector(stringQuery).classList.toggle('hidden')
        }
    </script>
</body>

</html>